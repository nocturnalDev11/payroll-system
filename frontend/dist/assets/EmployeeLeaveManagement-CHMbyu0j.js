import{a as g}from"./index-t--hEgTQ.js";import{h as d}from"./moment-C5S46NFB.js";import{_ as D,c as u,a as t,b as y,h as l,g as x,e as c,v as b,y as L,t as i,w as v,G as _,T as w,o as p,F as k,m as P,n as f}from"./index-D08fRg5P.js";const R={name:"AdminLeaveManagement",data(){return{leaveRequests:[],showDetailsModalVisible:!1,selectedLeave:{},searchQuery:"",filterStatus:"",dateRange:"",sortKey:"startDate",sortDirection:"desc",currentPage:1,itemsPerPage:10,isLoading:!1,toastMessage:"",toastType:"success"}},mounted(){this.fetchLeaveRequests()},computed:{filteredLeaveRequests(){let o=[...this.leaveRequests];if(this.searchQuery){const e=this.searchQuery.toLowerCase();o=o.filter(n=>n.employeeName.toLowerCase().includes(e)||n.employeeId.toLowerCase().includes(e))}if(this.filterStatus&&(o=o.filter(e=>e.status===this.filterStatus)),this.dateRange){const[e,n]=this.dateRange.split("-"),m=d(`${e}-${n}-01`).startOf("month").toDate(),s=d(m).endOf("month").toDate();o=o.filter(a=>{const r=d(a.startDate).toDate();return r>=m&&r<=s})}return o.sort((e,n)=>{const m=e[this.sortKey],s=n[this.sortKey];return this.sortKey==="startDate"||this.sortKey==="endDate"?this.sortDirection==="asc"?d(m).diff(d(s)):d(s).diff(d(m)):this.sortDirection==="asc"?m.localeCompare(s):s.localeCompare(m)}),o},totalPages(){return Math.ceil(this.filteredLeaveRequests.length/this.itemsPerPage)}},methods:{async fetchLeaveRequests(){try{this.isLoading=!0;const o=await g.get("http://localhost:7777/api/leaves/all");this.leaveRequests=o.data.map(e=>({...e,startDate:d(e.startDate).format("YYYY-MM-DD"),endDate:d(e.endDate).format("YYYY-MM-DD")}))||[]}catch(o){console.error("Failed to fetch leave requests:",o),this.showToast("Failed to load leave requests. Please try again.","error")}finally{this.isLoading=!1}},async refreshLeaveRequests(){await this.fetchLeaveRequests(),this.showToast("Leave requests refreshed successfully!","success")},showDetailsModal(o){this.selectedLeave={...o},this.showDetailsModalVisible=!0},closeDetailsModal(){this.showDetailsModalVisible=!1,this.selectedLeave={}},async approveLeave(o){try{(await g.put(`http://localhost:7777/api/leaves/${o}/approve`)).status===200&&(this.leaveRequests=this.leaveRequests.map(n=>n.id===o?{...n,status:"Approved"}:n),this.showDetailsModalVisible&&(this.selectedLeave.status="Approved"),this.showToast("Leave approved successfully!","success"))}catch(e){console.error("Failed to approve leave:",e),this.showToast("Failed to approve leave. Please try again.","error")}},async disapproveLeave(o){try{(await g.put(`http://localhost:7777/api/leaves/${o}/disapprove`)).status===200&&(this.leaveRequests=this.leaveRequests.map(n=>n.id===o?{...n,status:"Disapproved"}:n),this.showDetailsModalVisible&&(this.selectedLeave.status="Disapproved"),this.showToast("Leave disapproved successfully!","success"))}catch(e){console.error("Failed to disapprove leave:",e),this.showToast("Failed to disapprove leave. Please try again.","error")}},getStatusClass(o){switch(o){case"Pending":return"text-yellow-600 bg-yellow-50 px-2 py-1 rounded-md";case"Approved":return"text-green-600 bg-green-50 px-2 py-1 rounded-md";case"Disapproved":return"text-red-600 bg-red-50 px-2 py-1 rounded-md";default:return"text-gray-600 bg-gray-50 px-2 py-1 rounded-md"}},formatDate(o){return d(o).format("MMMM D, YYYY")},sortTable(o){this.sortKey===o?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortKey=o,this.sortDirection="asc")},applyDateFilter(){this.currentPage=1},prevPage(){this.currentPage>1&&this.currentPage--},nextPage(){this.currentPage<this.totalPages&&this.currentPage++},showToast(o,e="success"){this.toastMessage=o,this.toastType=e,setTimeout(()=>this.clearToast(),3e3)},clearToast(){this.toastMessage="",this.toastType="success"}}},q={class:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-1"},M={class:"max-w-8xl mx-auto"},C={class:"bg-white p-6 rounded-xl shadow-lg mb-6"},T={class:"flex justify-between items-center"},S={class:"bg-white rounded-xl shadow-lg p-5 mb-6 border border-gray-100"},F={class:"grid grid-cols-1 md:grid-cols-3 gap-5"},A={class:"relative"},V={class:"relative"},N={class:"relative"},Y={class:"relative"},K={class:"relative"},j={class:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100"},E={class:"px-6 py-4 border-b bg-gray-50 flex items-center justify-between"},Q={class:"text-sm text-gray-500"},I={key:0,class:"p-10 flex justify-center items-center"},B={key:1,class:"p-12 text-center"},O={key:0,class:"min-w-full divide-y divide-gray-200"},z={class:"bg-gray-50"},U={class:"material-icons text-xs ml-1"},G={class:"material-icons text-xs ml-1"},H={class:"material-icons text-xs ml-1"},J={class:"material-icons text-xs ml-1"},W={class:"bg-white divide-y divide-gray-200"},X={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},$={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ee={class:"px-6 py-4 whitespace-nowrap text-sm font-medium flex gap-2"},te=["onClick"],se=["onClick","disabled"],ae=["onClick","disabled"],re={key:2,class:"px-6 py-4 bg-gray-50 border-t flex items-center justify-between"},oe={class:"text-sm text-gray-700"},ie={class:"font-medium"},le={class:"font-medium"},ne={class:"font-medium"},de={class:"flex items-center gap-2"},ue=["disabled"],pe={class:"text-sm text-gray-700"},me=["disabled"],ce={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},ge={class:"bg-white p-6 rounded-xl shadow-lg max-w-2xl w-full transform transition-all duration-300 scale-100"},ye={class:"border-b border-gray-200 pb-4 mb-4"},xe={class:"flex justify-between items-center"},ve={class:"mb-4"},fe={class:"text-base font-medium text-gray-900"},he={class:"text-sm text-gray-600 mt-1"},be={class:"bg-gray-50 p-4 rounded-lg mb-4 border border-gray-200"},we={class:"text-sm text-gray-700 whitespace-pre-wrap"},De={class:"space-y-3 text-sm"},Le={class:"text-gray-700"},_e={class:"text-gray-700"},ke={class:"text-gray-700"},Pe={class:"mt-6 flex justify-end gap-3"},Re=["disabled"],qe=["disabled"],Me={class:"fixed bottom-4 right-4 z-50 space-y-4"},Ce={key:0,class:"max-w-sm w-full bg-white rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 overflow-hidden"},Te={class:"p-4 flex items-center gap-3"},Se={class:"text-sm font-medium text-gray-900"};function Fe(o,e,n,m,s,a){return p(),u("div",q,[t("div",M,[t("header",C,[t("div",T,[e[18]||(e[18]=t("h1",{class:"text-2xl font-bold text-gray-900 flex items-center gap-2"},[t("span",{class:"material-icons text-blue-600"},"event_note"),l(" Employee Leave Management ")],-1)),t("button",{onClick:e[0]||(e[0]=(...r)=>a.refreshLeaveRequests&&a.refreshLeaveRequests(...r)),class:"inline-flex items-center gap-2 bg-blue-500 text-white px-3 py-1.5 rounded-md text-sm font-medium hover:bg-blue-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5"},e[17]||(e[17]=[t("span",{class:"material-icons text-sm"},"refresh",-1),l(" Refresh ")]))])]),t("div",S,[t("div",F,[t("div",A,[e[21]||(e[21]=t("label",{for:"search",class:"block text-sm font-medium text-gray-700 mb-1"},"Search Employees",-1)),t("div",V,[e[20]||(e[20]=t("span",{class:"material-icons absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}," search ",-1)),x(t("input",{id:"search","onUpdate:modelValue":e[1]||(e[1]=r=>s.searchQuery=r),type:"text",placeholder:"Search by name or ID...",class:"w-full pl-10 pr-10 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all duration-200 text-sm"},null,512),[[b,s.searchQuery]]),s.searchQuery?(p(),u("button",{key:0,onClick:e[2]||(e[2]=r=>s.searchQuery=""),class:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-700 transition-all duration-200"},e[19]||(e[19]=[t("span",{class:"material-icons text-sm"},"clear",-1)]))):c("",!0)])]),t("div",N,[e[25]||(e[25]=t("label",{for:"statusFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"Filter by Status",-1)),t("div",Y,[e[23]||(e[23]=t("span",{class:"material-icons absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}," filter_list ",-1)),x(t("select",{id:"statusFilter","onUpdate:modelValue":e[3]||(e[3]=r=>s.filterStatus=r),class:"w-full pl-10 pr-9 py-2.5 border rounded-lg appearance-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all duration-200 text-sm"},e[22]||(e[22]=[t("option",{value:""},"All Statuses",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Disapproved"},"Disapproved",-1)]),512),[[L,s.filterStatus]]),e[24]||(e[24]=t("span",{class:"material-icons absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"}," arrow_drop_down ",-1))])]),t("div",K,[e[26]||(e[26]=t("label",{for:"dateRange",class:"block text-sm font-medium text-gray-700 mb-1"},"Date Range",-1)),x(t("input",{id:"dateRange","onUpdate:modelValue":e[4]||(e[4]=r=>s.dateRange=r),type:"month",class:"w-full px-10 py-2.5 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all duration-200 text-sm",onChange:e[5]||(e[5]=(...r)=>a.applyDateFilter&&a.applyDateFilter(...r))},null,544),[[b,s.dateRange]])])])]),t("div",j,[t("div",E,[e[27]||(e[27]=t("h2",{class:"text-lg font-medium text-gray-900"},"Leave Requests",-1)),t("span",Q,"Showing "+i(a.filteredLeaveRequests.length)+" "+i(a.filteredLeaveRequests.length===1?"request":"requests"),1)]),s.isLoading?(p(),u("div",I,e[28]||(e[28]=[t("div",{class:"flex flex-col items-center"},[t("div",{class:"loader ease-linear rounded-full border-4 border-t-4 border-blue-200 h-12 w-12 mb-4 animate-spin"}),t("h3",{class:"text-lg font-medium text-gray-600"},"Loading...")],-1)]))):a.filteredLeaveRequests.length===0?(p(),u("div",B,e[29]||(e[29]=[t("div",{class:"rounded-full bg-blue-100 p-4 mb-4 inline-flex"},[t("span",{class:"material-icons text-blue-600 text-3xl"},"event_busy")],-1),t("h3",{class:"text-xl font-semibold text-gray-900"},"No Leave Requests Found",-1),t("p",{class:"mt-2 text-gray-500 max-w-md mx-auto text-sm"}," There are no leave requests matching your criteria. Try adjusting your filters. ",-1)]))):c("",!0),y(_,{name:"table-fade",tag:"div",class:"overflow-x-auto"},{default:v(()=>[!s.isLoading&&a.filteredLeaveRequests.length>0?(p(),u("table",O,[t("thead",z,[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:e[6]||(e[6]=r=>a.sortTable("employeeName"))},[e[30]||(e[30]=l(" Employee Name ")),t("span",U,i(s.sortDirection==="asc"&&s.sortKey==="employeeName"?"arrow_drop_up":"arrow_drop_down"),1)]),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:e[7]||(e[7]=r=>a.sortTable("startDate"))},[e[31]||(e[31]=l(" Start Date ")),t("span",G,i(s.sortDirection==="asc"&&s.sortKey==="startDate"?"arrow_drop_up":"arrow_drop_down"),1)]),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:e[8]||(e[8]=r=>a.sortTable("endDate"))},[e[32]||(e[32]=l(" End Date ")),t("span",H,i(s.sortDirection==="asc"&&s.sortKey==="endDate"?"arrow_drop_up":"arrow_drop_down"),1)]),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:e[9]||(e[9]=r=>a.sortTable("status"))},[e[33]||(e[33]=l(" Status ")),t("span",J,i(s.sortDirection==="asc"&&s.sortKey==="status"?"arrow_drop_up":"arrow_drop_down"),1)]),e[34]||(e[34]=t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions",-1))])]),t("tbody",W,[(p(!0),u(k,null,P(a.filteredLeaveRequests,r=>(p(),u("tr",{key:r.id,class:"transition-all duration-200 hover:bg-gray-50"},[t("td",X,i(r.employeeName),1),t("td",Z,i(a.formatDate(r.startDate)),1),t("td",$,i(a.formatDate(r.endDate)),1),t("td",{class:f(["px-6 py-4 whitespace-nowrap text-sm font-semibold",a.getStatusClass(r.status)])},i(r.status),3),t("td",ee,[t("button",{onClick:h=>a.showDetailsModal(r),class:"inline-flex items-center gap-1.5 bg-blue-50 text-blue-600 py-1.5 px-2.5 rounded-md text-sm font-medium hover:bg-blue-100 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5"},e[35]||(e[35]=[t("span",{class:"material-icons text-xs"},"visibility",-1),l(" View ")]),8,te),t("button",{onClick:h=>a.approveLeave(r.id),disabled:r.status==="Approved",class:"inline-flex items-center gap-1.5 bg-green-50 text-green-600 py-1.5 px-2.5 rounded-md text-sm font-medium hover:bg-green-100 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5 disabled:opacity-50"},e[36]||(e[36]=[t("span",{class:"material-icons text-xs"},"check",-1),l(" Approve ")]),8,se),t("button",{onClick:h=>a.disapproveLeave(r.id),disabled:r.status==="Disapproved",class:"inline-flex items-center gap-1.5 bg-red-50 text-red-600 py-1.5 px-2.5 rounded-md text-sm font-medium hover:bg-red-100 transition-all duration-200 shadow-sm hover:shadow-md transform hover:-translate-y-0.5 disabled:opacity-50"},e[37]||(e[37]=[t("span",{class:"material-icons text-xs"},"close",-1),l(" Disapprove ")]),8,ae)])]))),128))])])):c("",!0)]),_:1}),!s.isLoading&&a.filteredLeaveRequests.length>s.itemsPerPage?(p(),u("div",re,[t("div",oe,[e[38]||(e[38]=l(" Showing ")),t("span",ie,i((s.currentPage-1)*s.itemsPerPage+1),1),e[39]||(e[39]=l(" to ")),t("span",le,i(Math.min(s.currentPage*s.itemsPerPage,a.filteredLeaveRequests.length)),1),e[40]||(e[40]=l(" of ")),t("span",ne,i(a.filteredLeaveRequests.length),1),e[41]||(e[41]=l(" requests "))]),t("div",de,[t("button",{onClick:e[10]||(e[10]=(...r)=>a.prevPage&&a.prevPage(...r)),disabled:s.currentPage===1,class:"p-2 rounded-md hover:bg-blue-100 transition-all duration-200 disabled:opacity-50 disabled:hover:bg-transparent text-gray-700"},e[42]||(e[42]=[t("span",{class:"material-icons"},"chevron_left",-1)]),8,ue),t("span",pe,i(s.currentPage)+" of "+i(a.totalPages),1),t("button",{onClick:e[11]||(e[11]=(...r)=>a.nextPage&&a.nextPage(...r)),disabled:s.currentPage===a.totalPages,class:"p-2 rounded-md hover:bg-blue-100 transition-all duration-200 disabled:opacity-50 disabled:hover:bg-transparent text-gray-700"},e[43]||(e[43]=[t("span",{class:"material-icons"},"chevron_right",-1)]),8,me)])])):c("",!0)]),y(w,{name:"modal-slide"},{default:v(()=>[s.showDetailsModalVisible?(p(),u("div",ce,[t("div",ge,[t("div",ye,[t("div",xe,[e[45]||(e[45]=t("h2",{class:"text-lg font-semibold text-gray-800"},"Leave Request Notification",-1)),t("button",{onClick:e[12]||(e[12]=(...r)=>a.closeDetailsModal&&a.closeDetailsModal(...r)),class:"text-gray-600 hover:text-gray-800 p-1 rounded-full hover:bg-gray-100 transition-all duration-200"},e[44]||(e[44]=[t("span",{class:"material-icons text-lg"},"close",-1)]))]),e[46]||(e[46]=t("div",{class:"text-sm text-gray-500 mt-2"},[l("From: HR System "),t("span",{class:"text-gray-400"},"|"),l(" To: Admin")],-1))]),t("div",ve,[t("h3",fe,"Subject: Leave Request for "+i(s.selectedLeave.employeeName),1),t("p",he,"Date: "+i(a.formatDate(s.selectedLeave.startDate))+" – "+i(a.formatDate(s.selectedLeave.endDate)),1)]),t("div",be,[t("p",we,i(s.selectedLeave.reason),1)]),t("div",De,[t("p",Le,[e[47]||(e[47]=t("span",{class:"font-medium text-gray-800"},"Employee:",-1)),l(" "+i(s.selectedLeave.employeeName),1)]),t("p",_e,[e[48]||(e[48]=t("span",{class:"font-medium text-gray-800"},"Employee ID:",-1)),l(" "+i(s.selectedLeave.employeeId),1)]),t("p",ke,[e[49]||(e[49]=t("span",{class:"font-medium text-gray-800"},"Status:",-1)),t("span",{class:f(a.getStatusClass(s.selectedLeave.status))},i(s.selectedLeave.status),3)])]),t("div",Pe,[t("button",{onClick:e[13]||(e[13]=r=>a.approveLeave(s.selectedLeave.id)),disabled:s.selectedLeave.status==="Approved",class:"px-4 py-2 bg-green-500 text-white rounded-md text-sm font-medium hover:bg-green-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 disabled:opacity-50"}," Approve ",8,Re),t("button",{onClick:e[14]||(e[14]=r=>a.disapproveLeave(s.selectedLeave.id)),disabled:s.selectedLeave.status==="Disapproved",class:"px-4 py-2 bg-red-500 text-white rounded-md text-sm font-medium hover:bg-red-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 disabled:opacity-50"}," Disapprove ",8,qe),t("button",{onClick:e[15]||(e[15]=(...r)=>a.closeDetailsModal&&a.closeDetailsModal(...r)),class:"px-4 py-2 bg-gray-500 text-white rounded-md text-sm font-medium hover:bg-gray-600 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5"}," Close ")])])])):c("",!0)]),_:1}),t("div",Me,[y(w,{"enter-active-class":"transform ease-out duration-300 transition","enter-from-class":"translate-y-2 opacity-0 sm:translate-y-0 sm:translate-x-2","enter-to-class":"translate-y-0 opacity-100 sm:translate-x-0","leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:v(()=>[s.toastMessage?(p(),u("div",Ce,[t("div",Te,[t("span",{class:f(["material-icons",s.toastType==="success"?"text-green-500":"text-red-500"])},i(s.toastType==="success"?"check_circle":"error"),3),t("p",Se,i(s.toastMessage),1),t("button",{onClick:e[16]||(e[16]=(...r)=>a.clearToast&&a.clearToast(...r)),class:"ml-auto flex-shrink-0 rounded-md text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 p-1"},e[50]||(e[50]=[t("span",{class:"material-icons text-sm"},"close",-1)]))])])):c("",!0)]),_:1})])])])}const Ye=D(R,[["render",Fe],["__scopeId","data-v-0a9f0bd1"]]);export{Ye as default};
