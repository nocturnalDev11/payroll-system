import{a as c}from"./index-t--hEgTQ.js";import{_ as m,c as i,a as e,e as y,F as x,m as g,B as p,u as f,o as l,t as d}from"./index-D08fRg5P.js";const w={data(){return{trashedEmployees:[],loading:!0,showModal:!1,employeeToDelete:null}},setup(){return{authStore:f()}},mounted(){this.authStore.isAdmin?this.fetchTrashedEmployees():this.$router.push("/unauthorized")},methods:{async fetchTrashedEmployees(){var s,t;try{this.loading=!0;const a=await c.get(`${p}/api/employees/trash`,{headers:{Authorization:`Bearer ${this.authStore.accessToken}`,"user-role":this.authStore.userRole}});this.trashedEmployees=a.data}catch(a){console.error("Error fetching trashed employees:",a),(((s=a.response)==null?void 0:s.status)===401||((t=a.response)==null?void 0:t.status)===403)&&(this.authStore.logout(),this.$router.push("/login"))}finally{this.loading=!1}},async restoreEmployee(s){var t,a,h,n;try{await c.put(`${p}/api/employees/trash/${s}/restore`,{},{headers:{Authorization:`Bearer ${this.authStore.accessToken}`,"user-role":this.authStore.userRole}}),this.trashedEmployees=this.trashedEmployees.filter(r=>r._id!==s)}catch(r){console.error("Error restoring employee:",{status:(t=r.response)==null?void 0:t.status,data:(a=r.response)==null?void 0:a.data,message:r.message}),alert(`Failed to restore employee: ${((n=(h=r.response)==null?void 0:h.data)==null?void 0:n.message)||"Unknown error"}`)}},confirmDelete(s){this.employeeToDelete=s,this.showModal=!0},async permanentDelete(){try{await c.delete(`${p}/api/employees/trash/${this.employeeToDelete}`,{headers:{Authorization:`Bearer ${this.authStore.accessToken}`,"user-role":this.authStore.userRole}}),this.trashedEmployees=this.trashedEmployees.filter(s=>s._id!==this.employeeToDelete),this.showModal=!1,this.employeeToDelete=null}catch(s){console.error("Error permanently deleting employee:",s)}},formatDate(s){return!s||isNaN(new Date(s))?"N/A":new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}}},_={class:"min-h-screen p-6"},b={key:0,class:"flex justify-center items-center h-64"},v={key:1,class:"bg-white shadow-lg rounded-lg overflow-hidden"},k={class:"min-w-full divide-y divide-gray-200"},D={class:"bg-white divide-y divide-gray-200"},E={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},S={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},T={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},A={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-600"},B={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},C=["onClick"],N=["onClick"],$={key:2,class:"flex flex-col items-center justify-center h-64 bg-white shadow-lg rounded-lg"},M={key:3,class:"fixed inset-0 bg-gray-600/50 bg-opacity-50 flex items-center justify-center z-50"},z={class:"bg-white rounded-lg p-6 shadow-xl max-w-sm w-full"},j={class:"flex justify-end space-x-4"};function R(s,t,a,h,n,r){return l(),i("div",_,[t[7]||(t[7]=e("header",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-800"},"Trash Bin"),e("p",{class:"text-gray-600"},"Manage employees moved to trash")],-1)),n.loading?(l(),i("div",b,t[2]||(t[2]=[e("div",{class:"animate-spin rounded-full h-16 w-16 border-t-4 border-blue-500"},null,-1)]))):n.trashedEmployees.length>0?(l(),i("div",v,[e("table",k,[t[3]||(t[3]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Employee ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Position"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Trashed Date"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions")])],-1)),e("tbody",D,[(l(!0),i(x,null,g(n.trashedEmployees,o=>(l(),i("tr",{key:o._id,class:"hover:bg-gray-50 transition-colors"},[e("td",E,d(o.empNo),1),e("td",S,d(`${o.firstName}
                            ${o.lastName}`),1),e("td",T,d(o.position),1),e("td",A,d(r.formatDate(o.trashedAt)),1),e("td",B,[e("button",{onClick:u=>r.restoreEmployee(o._id),class:"text-blue-600 hover:text-blue-800 mr-4 transition-colors"}," Restore ",8,C),e("button",{onClick:u=>r.confirmDelete(o._id),class:"text-red-600 hover:text-red-800 transition-colors"}," Delete Permanently ",8,N)])]))),128))])])])):(l(),i("div",$,t[4]||(t[4]=[e("svg",{class:"w-16 h-16 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/10.0/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"text-gray-600 text-lg"},"No employees in trash",-1)]))),n.showModal?(l(),i("div",M,[e("div",z,[t[5]||(t[5]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Confirm Permanent Deletion",-1)),t[6]||(t[6]=e("p",{class:"text-gray-600 mb-6"},"Are you sure you want to permanently delete this employee? This action cannot be undone.",-1)),e("div",j,[e("button",{onClick:t[0]||(t[0]=o=>n.showModal=!1),class:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 transition-colors"}," Cancel "),e("button",{onClick:t[1]||(t[1]=(...o)=>r.permanentDelete&&r.permanentDelete(...o)),class:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors"}," Delete ")])])])):y("",!0)])}const F=m(w,[["render",R],["__scopeId","data-v-7d94e11d"]]);export{F as default};
